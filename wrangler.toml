name = "simple-share"
compatibility_date = "2024-01-01"
main = "server/index.ts"
compatibility_flags = ["nodejs_compat"]

# Worker 模式：使用 assets 目录提供静态文件
# 注意：需要先构建前端，dist 目录必须存在
# 新版本使用 assets 配置替代 [site]
[assets]
directory = "dist"
binding = "ASSETS"

# 本地开发配置
# 注意：绑定配置通过环境变量或 Dashboard 配置
# 如果设置了 D1_DATABASE_ID 环境变量，会自动绑定 D1 数据库
# 如果未设置，需要在 Cloudflare Dashboard 中手动绑定
# 这样在自动部署时，如果环境变量未设置，Dashboard 中的绑定会保留
# [[d1_databases]]
# binding = "DB"
# database_name = "simpleshare-db"
# database_id = "${D1_DATABASE_ID}"  # 从环境变量读取

# [[r2_buckets]]
# binding = "FILES"
# bucket_name = "simpleshare-files"

[vars]
JWT_SECRET = "dev-jwt-secret-change-in-production"
R2_PUBLIC_URL = "https://your-r2-domain.com"

# 生产环境配置
[env.production]
name = "simple-share"

# 生产环境绑定（通过 Dashboard 配置，不在此处配置）
# 如果需要通过代码配置，取消下面的注释并填入 database_id
# [[env.production.d1_databases]]
# binding = "DB"
# database_name = "simpleshare-db"
# database_id = "YOUR_DATABASE_ID_HERE"

# [[env.production.r2_buckets]]
# binding = "FILES"
# bucket_name = "simpleshare-files"

[env.production.vars]
JWT_SECRET = "your-jwt-secret-key-change-in-production"
R2_PUBLIC_URL = "https://your-r2-domain.com"

